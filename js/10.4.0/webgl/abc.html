
const instanceEntries = coordinateSets.map(coordinates => {
  const { instanceData, instanceCount } = createInstanceData(coordinates);
  const instanceBuffer = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, instanceBuffer);
  gl.bufferData(gl.ARRAY_BUFFER, instanceData, gl.STATIC_DRAW);
  return { instanceBuffer, instanceCount };
});  

instanceEntries.forEach(entry => {
  gl.bindBuffer(gl.ARRAY_BUFFER, entry.instanceBuffer);
  bindInstanceAttributes(instanceAttributes, 1);

  lineStyles.forEach(style => {
    setLineUniforms(style);
    ext.drawElementsInstancedANGLE(gl.TRIANGLES, quadIndices.length, gl.UNSIGNED_SHORT, 0, entry.instanceCount);
  });
});
