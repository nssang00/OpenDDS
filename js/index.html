<!DOCTYPE html>
<html>
  <head>
    <title>JavaScript Sandbox</title>
    <meta charset="UTF-8" />
  </head>

  <body>
    <div id="app"></div>
    <script>
const xmlString = `<MapStyle Version="1.0">	
<Style name="BB010T03" type="Label">
		<Font>굴림</Font>
		<Size>8</Size>
		<Color>255, 97, 17, 146</Color>
		<Bold>false</Bold>
		<Italic>false</Italic>
		<Underline>false</Underline>
		<OffsetX>23</OffsetX>
		<OffsetY>-2</OffsetY>
		<Align>4</Align>
	</Style>
	<Style name="Agg" type="point">
		<OffsetX>0</OffsetX>
		<OffsetY>0</OffsetY>
		<PointLayer type="PICTURE">
			<Picture>ddd.png</Picture>
		</PointLayer>
	</Style>
	<Style name="Adfs" type="line">
		<LineLayer type="DASH">
			<Color>255, 0, 0, 0</Color>
			<Width>1</Width>
			<JoinType>2</JoinType>
			<Dash>
				<DashItem>6</DashItem>
				<DashItem>3</DashItem>
				<DashItem>6</DashItem>
				<DashItem>3</DashItem>
			</Dash>
		</LineLayer>
		<LineLayer type="PICTURE">
			<Picture>dfd.png</Picture>
			<TextureLine>false</TextureLine>
			<Width>8</Width>
		</LineLayer>		
	</Style>
	<Style name="AL015A08" type="polygon">
		<PolygonLayer type="SIMPLE">
			<Color>255, 255, 255, 255</Color>
			<Transparent>true</Transparent>
			<LineLayer type="PICTURE">
				<Picture>No_Fish.png</Picture>
				<TextureLine>false</TextureLine>
			</LineLayer>
		</PolygonLayer>
  </Style>
</MapStyle>`;
function parseXML(xmlString) {
  const parser = new DOMParser();
  const xmlDoc = parser.parseFromString(xmlString, "text/xml");

  let styles = [];
  const styleNodes = xmlDoc.getElementsByTagName("Style");

  for (let style of styleNodes) {
    let styleObj = {
      name: style.getAttribute("name"),
      type: style.getAttribute("type"),
    };

    switch (styleObj.type) {
      case "point":
        Object.assign(styleObj, parsePointLayers(style));
        break;
      case "line":
        Object.assign(styleObj, parseLineLayers(style));
        break;
      case "polygon":
        Object.assign(styleObj, parsePolygonLayers(style));
        break;
      case "Label":
        Object.assign(styleObj, parseLabelLayers(style));
        break;
      default:
        break;
    }

    styles.push(styleObj);
  }

  function parsePointLayers(styleNode) {
    return {
      //name: styleNode.getAttribute("name"),
      //type: styleNode.getAttribute("type"),
      OffsetX: styleNode.getElementsByTagName("OffsetX")[0].textContent,
      OffsetY: styleNode.getElementsByTagName("OffsetX")[0].textContent,
      PointLayers: Array.from(styleNode.getElementsByTagName("PointLayer")).map(layer => {
        const layerObj = { type: layer.getAttribute("type") };
        Array.from(layer.children).forEach(child => {

          if (child.children.length === 0) {
            layerObj[child.tagName] = child.textContent;
          } else {
            layerObj[child.tagName] = [];
            for (const item of child.children) {
              layerObj[child.tagName].push(item.textContent);
            }
          }

        });
        return layerObj;
      })
    };
  }

  function parseLineLayers(styleNode) {
    return {
      //name: styleNode.getAttribute("name"),
      //type: styleNode.getAttribute("type"),
      //OffsetX: styleNode.getElementsByTagName("OffsetX")[0].textContent,
      //OffsetY: styleNode.getElementsByTagName("OffsetX")[0].textContent,
      LineLayers: Array.from(styleNode.getElementsByTagName("LineLayer")).map(layer => {
        const layerObj = { type: layer.getAttribute("type") };
        Array.from(layer.children).forEach(child => {

          if (child.children.length === 0) {
            layerObj[child.tagName] = child.textContent;
          } else {
            layerObj[child.tagName] = [];
            for (const item of child.children) {
              layerObj[child.tagName].push(item.textContent);
            }
          }

        });
        return layerObj;
      })
    };
  }

  function parseLabelLayers(styleNode) {

    let styleObj = {};
    //  name: style.getAttribute("name"),
    //  type: style.getAttribute("type"),
    //};

    for (let child of styleNode.children) {
      if (child.children.length === 0) {
        styleObj[child.tagName] = child.textContent;
      } else {
        styleObj[child.tagName] = [];
        for (const item of child.children) {
          styleObj[child.tagName].push(item.textContent);
        }
      }
      console.log(child.tagName + " : " + styleObj[child.tagName]);
    }
    return styleObj;
  }


  function parsePolygonLayers(styleNode) {
    // 구현 필요
  }

}

parseXML(xmlString);


    </script>
  </body>
</html>
